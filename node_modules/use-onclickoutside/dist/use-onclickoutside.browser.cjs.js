'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var react = require('react');
var arePassiveEventsSupported = require('are-passive-events-supported');
var useLatest = require('use-latest');

function _interopDefault (e) { return e && e.__esModule ? e : { 'default': e }; }

var arePassiveEventsSupported__default = /*#__PURE__*/_interopDefault(arePassiveEventsSupported);
var useLatest__default = /*#__PURE__*/_interopDefault(useLatest);

var MOUSEDOWN = 'mousedown';
var TOUCHSTART = 'touchstart';
var events = [MOUSEDOWN, TOUCHSTART];

var getOptions = function getOptions(event) {
  if (event !== TOUCHSTART) {
    return;
  }

  if (arePassiveEventsSupported__default['default']()) {
    return {
      passive: true
    };
  }
};

function useOnClickOutside(ref, handler) {

  var handlerRef = useLatest__default['default'](handler);
  react.useEffect(function () {
    if (!handler) {
      return;
    }

    var listener = function listener(event) {
      if (!ref.current || !handlerRef.current || ref.current.contains(event.target)) {
        return;
      }

      handlerRef.current(event);
    };

    events.forEach(function (event) {
      document.addEventListener(event, listener, getOptions(event));
    });
    return function () {
      events.forEach(function (event) {
        document.removeEventListener(event, listener, getOptions(event));
      });
    };
  }, [!handler]);
}

exports.default = useOnClickOutside;
